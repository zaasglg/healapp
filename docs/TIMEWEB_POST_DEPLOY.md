# Что делать после деплоя в Timeweb Apps

## Шаг 1: Проверка статуса деплоя

1. **Дождитесь завершения:**
   - В разделе "Деплой" → "Логи деплоя"
   - Должно появиться сообщение "Deploy successful" или "Application is running"
   - Обычно занимает 5-15 минут

2. **Проверьте статус:**
   - Перейдите в "Дашборд"
   - Убедитесь, что статус приложения "Running" (зеленый)

## Шаг 2: Получение адреса приложения

1. **Перейдите в раздел "Сеть":**
   - В верхнем меню найдите вкладку "Сеть"
   - Там будет указан:
     - **IP адрес** (например: `185.xxx.xxx.xxx`)
     - Или **домен** (например: `healapp-supabase.timeweb.cloud`)

2. **Скопируйте адрес** — он понадобится для обновления переменных

## Шаг 3: Обновление переменных окружения

1. **Перейдите в "Настройки":**
   - В верхнем меню найдите вкладку "Настройки"
   - Найдите раздел "Переменные окружения"

2. **Обновите две переменные:**
   - `SUPABASE_SITE_URL` → замените `localhost` на ваш IP/домен:
     ```
     http://ваш_ip_или_домен:54321
     ```
   
   - `SUPABASE_URI_ALLOW_LIST` → замените `localhost` на ваш IP/домен:
     ```
     http://ваш_ip_или_домен:54321,http://localhost:54321
     ```

3. **Сохраните изменения**

4. **Перезапустите приложение:**
   - Вернитесь в "Деплой"
   - Нажмите "Перезапустить" или "Redeploy"

## Шаг 4: Проверка работы

1. **Supabase Studio:**
   - Откройте в браузере: `http://ваш_ip_или_домен:54324`
   - Должен открыться интерфейс Supabase Studio

2. **API Gateway:**
   - Откройте: `http://ваш_ip_или_домен:54321/rest/v1/`
   - Должен вернуться JSON ответ

3. **Проверьте логи:**
   - Перейдите в "Логи приложения"
   - Убедитесь, что нет ошибок

## Шаг 5: Подключение по SSH (если нужно)

Если Timeweb предоставляет SSH доступ:

1. **Найдите данные для SSH:**
   - В разделе "Настройки" → "SSH доступ"
   - Или в разделе "Сеть" → "SSH ключи"

2. **Подключитесь:**
   ```powershell
   ssh root@ваш_ip_адрес
   ```

3. **Полезные команды:**
   ```bash
   # Проверка статуса контейнеров
   docker compose ps
   
   # Просмотр логов
   docker compose logs -f
   
   # Перезапуск контейнеров
   docker compose restart
   
   # Остановка всех контейнеров
   docker compose down
   
   # Запуск всех контейнеров
   docker compose up -d
   ```

## Если что-то не работает

1. **Проверьте логи:**
   - "Логи приложения" → смотрите ошибки
   - "Логи деплоя" → проверьте процесс развертывания

2. **Проверьте переменные окружения:**
   - Убедитесь, что все переменные заполнены
   - Особенно проверьте секреты (JWT_SECRET, ANON_KEY, SERVICE_ROLE_KEY)

3. **Проверьте порты:**
   - В разделе "Сеть" убедитесь, что порты открыты:
     - `54321` (API)
     - `54322` (PostgreSQL)
     - `54324` (Studio)
     - `54325` (Functions)

4. **Перезапустите приложение:**
   - В разделе "Деплой" → "Перезапустить"

## Следующие шаги

После успешного запуска:
1. ✅ Примените миграции базы данных (они должны примениться автоматически)
2. ✅ Настройте фронтенд для работы с вашим Supabase
3. ✅ Протестируйте основные функции

